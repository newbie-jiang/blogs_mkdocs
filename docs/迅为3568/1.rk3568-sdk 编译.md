# RK3568 sdk 编译   （ubuntu18）



## 编译 （编译之前确保交叉编译工具链和依赖库没问题）

- 此sdk是北京迅为电子已经适配了所有驱动的源码，现在编译出整个镜像，之后使用单独的kernel更新进行驱动开发，只更新kernel就行，这样可以验证自己的kernel

01_【iTOP-RK3568开发板】基础资料\05_iTOP-RK3568开发板Linux源码\01_Linux系统源码\rk356x_linux_20250807.tar.xz

```
# 1) 解压
tar -xvf rk356x_linux_20250807.tar.xz 
```

编译前可选屏幕配置

```
vim /kernel/arch/arm64/boot/dts/rockchip/topeet_screen_choose.dtsi
```

![image-20250818022323982](https://newbie-typora.oss-cn-shenzhen.aliyuncs.com/TyporaJPG/image-20250818022323982.png)

单独编译

```
查看编译帮助
./build -h
```



```
./build.sh uboot
./build.sh kernel
./build.sh recovery

 (看build.sh脚本里有没有写死置文件路径，有则跳过这个步骤)
./build.sh BoardConfig-rk3568-evb1-ddr4-v10.mk 
//三选1
./build.sh buildroot   ./build.sh debian  ./build.sh yocto
```

- ./build.sh uboot 编译完成后生成 uboot.img 到 u-boot 目录
- ./build.sh kernel 编译完成后映像文件 kernel.img、resource.img 会打包成 boot.img 放到 kernel 目录
- ./build.sh recovery  编译完成后生成recovery.img 到 rockdev目录
- ./build.sh rootfs

![image-20250818163406810](https://newbie-typora.oss-cn-shenzhen.aliyuncs.com/TyporaJPG/image-20250818163406810.png)

## buildroot打包成updateimg 镜像

上面 Kernel/U-Boot/Recovery/Rootfs 各个部分的编译后，进入工程目录根目录执行以下命令自动完成所有固件打包到 rockdev 目录下。

### 打包方法一：

输入以下命令打包：

```
./mkfirmware.sh
```

输入以下命令，打包 update.img 镜像。

```
./build.sh updateimg
```

### 打包方法二：

也可以输入以下命令打包所有启动系统需要的镜像

```
./build.sh firmware
```

输入以下命令，打包 update.img 镜像。（打包完成会在 rockdev 目录下生成 update.img）

```
./build.sh updateimg
```



### 全自动编译

进入源码根目录执行以下命令自动完成所有的编译。如果想自动全编译 buildroot 文件系

统，输入以下命令：

```
export RK_ROOTFS_SYSTEM=buildroot 
./build.sh all
./build.sh firmware
./build.sh updateimg
```

输入上面的命令后，会自动编译 uboot kernel recovery buildroot 打包。打包完成会在rockdev 目录下生成 update.img。







## 手动安装交叉编译工具链



**下载工具链**

```
wget https://releases.linaro.org/components/toolchain/binaries/6.3-2017.05/aarch64-linux-gnu/gcc-linaro-6.3.1-2017.05-x86_64_aarch64-linux-gnu.tar.xz
```

**解压到 /opt（推荐路径）**

```
sudo mkdir -p /opt/toolchains
sudo tar -xf gcc-linaro-6.3.1-2017.05-x86_64_aarch64-linux-gnu.tar.xz -C /opt/toolchains
```

解压后目录：

```
/opt/toolchains/gcc-linaro-6.3.1-2017.05-x86_64_aarch64-linux-gnu/
```

**添加到 PATH**

```
echo 'export PATH=/opt/toolchains/gcc-linaro-6.3.1-2017.05-x86_64_aarch64-linux-gnu/bin:$PATH' >> ~/.bashrc
source ~/.bashrc
```

**测试**

```
aarch64-linux-gnu-gcc -v
```



## 安装编译依赖库

```
# 1) 装 Python & 常见依赖
sudo apt update
sudo apt install -y python3 python-is-python3  # 提供 /usr/bin/python -> python3
sudo apt install -y build-essential bc bison flex libssl-dev liblz4-tool expect \
    libncurses5-dev libelf-dev device-tree-compiler dwarves \
    swig python3-distutils python3-setuptools 
    
sudo apt install -y lz4
```







