# Linux 内核模块操作指令速查

## 1️⃣ 加载模块

```
# 用 insmod，直接指定 .ko 文件路径
insmod /path/to/module.ko
```

> 适合精简 rootfs，没有 `/lib/modules` 时使用。

```
# 用 modprobe（需要 /lib/modules/$(uname -r) 和 modules.dep）
modprobe module_name
```

------

## 2️⃣ 查看已加载模块

```
# 查看所有模块（完整版系统常用）
lsmod

# 在精简系统中，等价方式
cat /proc/modules

# 查看内核日志，确认模块初始化打印
dmesg | tail -n 20
```

------

## 3️⃣ 卸载模块

```
# 基本用法
rmmod module_name

# 推荐用 modprobe 卸载（支持依赖）
modprobe -r module_name
```

------

## 4️⃣ 常见验证流程（HelloWorld 模块举例）

```
# 加载
insmod /tmp/helloworld.ko

# 确认已加载
cat /proc/modules | grep helloworld
dmesg | tail -n 20

# 卸载
rmmod helloworld
dmesg | tail -n 20
```

