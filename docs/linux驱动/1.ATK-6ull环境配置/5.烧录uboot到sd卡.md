## 烧录uboot到sd卡

两种方式，使用nxp官方下载工具或者dd工具

`imxdownload` 是 NXP 提供的一个特定于 i.MX 处理器系列的烧录工具。这个工具是为了烧录 i.MX 处理器的 boot ROM 而设计的，通常用于烧录 U-Boot bootloader 到设备上。这个工具通常会与 i.MX 处理器的特定硬件接口一起使用，例如 USB 或 UART，来进行烧录。

### `imxdownload` 与 `dd` 的区别：

1. **特定性**：
   - `imxdownload` 是针对 NXP 的 i.MX 系列处理器设计的，而 `dd` 是一个通用的 UNIX 工具，可用于任何 UNIX 系统上，用于复制和转换文件。
2. **接口**：
   - `imxdownload` 通常使用特定的硬件接口（例如 USB 或 UART）来烧录 i.MX 处理器，而 `dd` 则直接操作块设备，例如 SD 卡。
3. **用途**：
   - `imxdownload` 主要用于烧录 bootloader 到 i.MX 处理器的内部存储或外部存储中，而 `dd` 可以用于复制任何文件和设备内容，包括制作和恢复磁盘映像。
4. **操作层级**：
   - `imxdownload` 操作的是处理器级别，直接与处理器的 boot ROM 交互，而 `dd` 操作的是文件系统级别，与块设备交互。

### 选择工具：

- 如果您正在使用 NXP 的 i.MX 系列处理器，并且需要通过特定的硬件接口烧录 bootloader，那么 `imxdownload` 可能是更合适的选择。
- 如果您只是需要将 bootloader 烧录到一个块设备（例如 SD 卡）上，并且不需要特定的硬件接口，那么 `dd` 应该足够了。

### 举例说明：

1. **使用特定硬件接口**：
   - 如果您使用的是 i.MX 处理器，并且需要通过 USB 接口来烧录 bootloader 到处理器的内部存储中，那么您可能需要使用 `imxdownload` 这样的特定工具。
2. **不需要特定硬件接口**：
   - 如果您只是需要将 bootloader 烧录到一个 SD 卡上，这个 SD 卡可以直接通过计算机的 SD 卡读卡器访问，那么您可以使用 `dd` 命令，因为这种情况下不需要与特定的处理器或硬件接口进行直接通信。

简而言之，如果您的烧录过程只涉及到标准的、通用的块设备接口，例如 SD 卡读卡器，那么 `dd` 命令应该是足够的。如果烧录过程需要与特定的处理器或硬件平台的特定接口进行通信，那么您可能需要使用特定于该硬件平台的烧录工具。

## dd工具烧录

我们使用dd工具来烧录吧，毕竟具有通用性

要将U-Boot烧写到SD卡，您通常会使用`dd`命令。`dd`命令可以用于复制文件或设备内容，通常用于制作或复制磁盘映像。在这种情况下，您将使用`dd`命令将编译好的U-Boot二进制文件（通常是`u-boot.bin`或`u-boot.imx`）复制到SD卡。

### 步骤：

1. **找到U-Boot二进制文件**

   - 确定U-Boot二进制文件的位置。这通常是`u-boot.bin`或`u-boot.imx`。

2. **卸载SD卡**

   - 在写入之前，确保SD卡是卸载的。

   ```
   sudo umount /dev/sda1
   ```

3. **使用dd命令烧写U-Boot**

   - 使用`dd`命令将U-Boot烧写到SD卡。请替换`<u-boot-file>`为您的U-Boot二进制文件的路径。

   ```
   sudo dd iflag=dsync oflag=dsync if=<u-boot-file> of=/dev/sda seek=2
   ```

   - 这里，`if`是输入文件，`of`是输出文件（您的SD卡），`bs`是块大小，`seek`是跳过的块数。`seek=2`通常用于跳过SD卡的分区表。

4. **同步**

   `iflag=dsync` 和 `oflag=dsync`，这两个选项会确保每次读取和写入都是同步的，这意味着每次读取或 写入操作都会等待物理 I/O 操作完成。这可以确保数据的完整性

### 注意：

- 请小心使用`dd`命令，因为它会覆盖目标设备（在这种情况下是SD卡）的内容。确保`of`参数是正确的，以避免覆盖系统的其他部分。
- 在执行`dd`命令之前，确保没有挂载SD卡的任何分区。
- 请根据您的U-Boot版本和目标硬件，检查相关的文档以确定正确的`dd`命令参数，特别是`bs`和`seek`参数。

了解以上内容以后，我的uboot 路径：/root/uboot

[![image-20230929105840414](https://newbie-typora.oss-cn-shenzhen.aliyuncs.com/TyporaJPG/image-20230929105840414.png)](https://newbie-typora.oss-cn-shenzhen.aliyuncs.com/TyporaJPG/image-20230929105840414.png)

查看挂在设备并卸载

```
lsblk
sudo umount /dev/sda1
```

[![image-20230929110000451](https://newbie-typora.oss-cn-shenzhen.aliyuncs.com/TyporaJPG/image-20230929110000451.png)](https://newbie-typora.oss-cn-shenzhen.aliyuncs.com/TyporaJPG/image-20230929110000451.png)

**烧写U-Boot**

注意：是sda,不是sda1分区

我当前是在uboot目录下

```
sudo dd iflag=dsync oflag=dsync if=u-boot.imx of=/dev/sda seek=2
```

[![image-20230929110521672](https://newbie-typora.oss-cn-shenzhen.aliyuncs.com/TyporaJPG/image-20230929110521672.png)](https://newbie-typora.oss-cn-shenzhen.aliyuncs.com/TyporaJPG/image-20230929110521672.png)

0.07S，一个字-->快, 不过看到这种一般是没烧写上去

查看所有sd

```
 ls /dev/sd*
```

[![image-20230929124421313](https://newbie-typora.oss-cn-shenzhen.aliyuncs.com/TyporaJPG/image-20230929124421313.png)](https://newbie-typora.oss-cn-shenzhen.aliyuncs.com/TyporaJPG/image-20230929124421313.png)

这里有一个虚拟的sdb ，删掉

```
sudo rm -rf /dev/sdb
```

再次查看

[![image-20230929124518698](https://newbie-typora.oss-cn-shenzhen.aliyuncs.com/TyporaJPG/image-20230929124518698.png)](https://newbie-typora.oss-cn-shenzhen.aliyuncs.com/TyporaJPG/image-20230929124518698.png)

再次烧写，烧写成功一般是这样

[![image-20230929125820303](https://newbie-typora.oss-cn-shenzhen.aliyuncs.com/TyporaJPG/image-20230929125820303.png)](https://newbie-typora.oss-cn-shenzhen.aliyuncs.com/TyporaJPG/image-20230929125820303.png)

硬件上 BOOT 设置从 SD 卡启动，使用 USB 线将 USB_TTL 和电脑连接，也就是将开发板的串口 1 连接到电脑上。打开MobaXterm，设置好串口参数并打开，最后复位开发板。在 MobaXterm 上出现“Hit any key to stop autoboot: ”倒计时的时候按下键盘上的回车键，默认是 3 秒倒计时，在 3 秒倒计时结束以后如果没有按下回车键的话 uboot 就会使用默认参数来启动 Linux 内核了。如果在 3 秒倒计时结束之前按下回车键，那么就会进入 uboot 的命令行模式，否则会引导进入linux内核可以理解为windows开机时的bios，开机狂按某个按键会进入bios，不按正常启动系统

[![image-20230929130009431](https://newbie-typora.oss-cn-shenzhen.aliyuncs.com/TyporaJPG/image-20230929130009431.png)](https://newbie-typora.oss-cn-shenzhen.aliyuncs.com/TyporaJPG/image-20230929130009431.png)

## NXP官方工具imxdownload烧录

https://newbie-typora.oss-cn-shenzhen.aliyuncs.com/tools/imxdownload

将该工具放在uboot目录下，给予执行权限

[![image-20230929130624272](https://newbie-typora.oss-cn-shenzhen.aliyuncs.com/TyporaJPG/image-20230929130624272.png)](https://newbie-typora.oss-cn-shenzhen.aliyuncs.com/TyporaJPG/image-20230929130624272.png)

```
chmod 777 imxdownload
```

烧写命令 //烧写到SD卡中

```
./imxdownload u-boot.bin /dev/sda 
```

[![image-20230929130742589](https://newbie-typora.oss-cn-shenzhen.aliyuncs.com/TyporaJPG/image-20230929130742589.png)](https://newbie-typora.oss-cn-shenzhen.aliyuncs.com/TyporaJPG/image-20230929130742589.png)

再次将SD插入开发板启动看一下没问题的（115200）

[![image-20230929130852681](https://newbie-typora.oss-cn-shenzhen.aliyuncs.com/TyporaJPG/image-20230929130852681.png)](https://newbie-typora.oss-cn-shenzhen.aliyuncs.com/TyporaJPG/image-20230929130852681.png)

## 总结：

烧写uboot到SD卡时候使用dd工具，具有通用性。
