

提供了vmware配置好的镜像，sdk包含在里面，镜像安装好以后，输入登录密码 ubuntu

用户目录有一个文件 tina-v853-100ask.tar.gz

解压

```
tar -xzvf tina-v853-100ask.tar.gz
```

设置编译环境

```
cd tina-v853-100ask/
source build/envsetup.sh 
lunch
```

编译

```
make -j16
```

打包

```
pack
```



![image-20250722163103565](https://newbie-typora.oss-cn-shenzhen.aliyuncs.com/TyporaJPG/image-20250722163103565.png)



```
cd out/v853-100ask
```



```shell
ubuntu@ubuntu1804:~/tina-v853-100ask/out/v853-100ask$ ls
aw_pack_src  boot.img  compile_dir  image  md5sums  packages  rootfs.img  sha256sums  staging_dir  tina_v853-100ask_uart0.img  v853-100ask-boot.img  v853-100ask-uImage  v853-100ask-zImage
```

**tina_v853-100ask_uart0.img  为打包好的系统镜像，可以直接烧录**



# 更改分区大小

添加包

```
make menuconfig
```

![image-20250722164624195](https://newbie-typora.oss-cn-shenzhen.aliyuncs.com/TyporaJPG/image-20250722164624195.png)

再次编译

```
make -j16
```

打包

```
pack
```

打包失败，提示

**分区表（MBR）和 rootfs 文件太大，超出了分配的分区空间**，导致**烧录镜像生成失败**。

![image-20250722164805772](https://newbie-typora.oss-cn-shenzhen.aliyuncs.com/TyporaJPG/image-20250722164805772.png)

```
ERROR: dl file rootfs.fex size too large
ERROR: filename = rootfs.fex 
ERROR: dl_file_size = 53760 sector
ERROR: part_size = 35840 sector
update_for_part_info -1
ERROR: update mbr file fail
ERROR: update_mbr failed
```



- 当前设置的大小 35840 sector  
- 当前需要的镜像 53760 sector



## 解决错误

### **增大 rootfs 分区大小**

#### 直接修改分区表

```
vim device/config/chips/v853/configs/100ask/linux/sys_partition.fex
```



```
;    mbr的大小, 以Kbyte为单位
;****************************************************
[mbr]
size = 4096

;********************************************************************************************************
;                                              分区配置
;
;
;  partition 定义范例:
;    [partition]                ;  //表示是一个分区
;    name        = USERFS2      ; //分区名称
;    size        = 16384        ; //分区大小 单位: 扇区.分区表示个数最多2^31 * 512 = 2T
;    downloadfile = "123.fex"   ; //下载文件的路径和名称，可以使用相对路径，相对是指相对于image.cfg文件所在分区。也可以使用绝对路径
;    keydata     = 1            ; //私有数据分区，重新量产数据将不丢失
;    encrypt     = 1            ; //采用加密方式烧录，将提供数据加密，但损失烧录速度
;    user_type   = ?            ; //私有用法
;    verify      = 1            ; //要求量产完成后校验是否正确
;
; 注：1、name唯一, 不允许同名
;     2、name最大12个字符
;     3、size = 0, 将创建一个无大小的空分区
;     4、为了安全和效率考虑，分区大小最好保证为16M字节的整数倍
;********************************************************************************************************
[partition_start]

[partition]
    name         = boot-resource
    size         = 6016
    downloadfile = "boot-resource.fex"
    user_type    = 0x8000

[partition]
    name         = env
    size         = 1008
    downloadfile = "env.fex"
    user_type    = 0x8000

[partition]
    name         = boot
    ;size         = 4096
    size         = 25200
    downloadfile = "boot.fex"
    user_type    = 0x8000

[partition]
    name         = rootfs
    size         = 35840
    downloadfile = "rootfs.fex"
    user_type    = 0x8000
                                            
```



将rootfs 的大小由35840 更改为53760 即可

更改后重新打包

```
pack
```

就成功打包了镜像

![image-20250722165738879](https://newbie-typora.oss-cn-shenzhen.aliyuncs.com/TyporaJPG/image-20250722165738879.png)





烧录后测试 lv_g2d_test

![image-20250722170354933](https://newbie-typora.oss-cn-shenzhen.aliyuncs.com/TyporaJPG/image-20250722170354933.png)