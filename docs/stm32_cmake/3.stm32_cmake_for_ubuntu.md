# stm32 cmake for ubuntu

stm32 cubemx可生成cmake工程，（注意需要较新版本才有）

windwos下编译很慢，推荐linux下编译，这里使用ubuntu编译



安装编译环境

```
sudo apt update
sudo apt install gcc-arm-none-eabi
sudo apt install cmake
sudo apt install make
```

## 编译测试

先看下文件

```
$ tree -L 3
.
|-- CMakeLists.txt
|-- CMakePresets.json
|-- Core
|   |-- Inc
|   |   |-- adc.h
|   |   |-- crc.h
|   |   |-- dma.h
|   |   |-- dma2d.h
|   |   |-- fmc.h
|   |   |-- gpio.h
|   |   |-- i2c.h
|   |   |-- jpeg.h
|   |   |-- jpeg_utils_conf.h
|   |   |-- ltdc.h
|   |   |-- main.h
|   |   |-- memorymap.h
|   |   |-- spi.h
|   |   |-- stm32h7xx_hal_conf.h
|   |   |-- stm32h7xx_it.h
|   |   |-- tim.h
|   |   `-- usart.h
|   `-- Src
|       |-- adc.c
|       |-- crc.c
|       |-- dma.c
|       |-- dma2d.c
|       |-- fmc.c
|       |-- gpio.c
|       |-- i2c.c
|       |-- jpeg.c
|       |-- ltdc.c
|       |-- main.c
|       |-- memorymap.c
|       |-- spi.c
|       |-- stm32h7xx_hal_msp.c
|       |-- stm32h7xx_hal_timebase_tim.c
|       |-- stm32h7xx_it.c
|       |-- syscalls.c
|       |-- sysmem.c
|       |-- system_stm32h7xx.c
|       |-- tim.c
|       `-- usart.c
|-- Drivers
|   |-- CMSIS
|   |   |-- Core
|   |   |-- Core_A
|   |   |-- DSP
|   |   |-- Device
|   |   |-- Include
|   |   |-- LICENSE.txt
|   |   |-- NN
|   |   |-- RTOS
|   |   |-- RTOS2
|   |   `-- docs
|   `-- STM32H7xx_HAL_Driver
|       |-- Inc
|       |-- LICENSE.txt
|       `-- Src
|-- STM32H750XB.ioc
|-- STM32H750XX_FLASH.ld
|-- Utilities
|   `-- JPEG
|       |-- LICENSE.txt
|       |-- jpeg_utils.c
|       |-- jpeg_utils.h
|       `-- jpeg_utils_conf_template.h
|-- cmake
|   |-- gcc-arm-none-eabi.cmake
|   `-- stm32cubemx
|       `-- CMakeLists.txt
`-- startup_stm32h750xx.s

21 directories, 50 files

```

命令行编译

```
# 进入工程根目录
cmake -S . -B build -DCMAKE_TOOLCHAIN_FILE=cmake/gcc-arm-none-eabi.cmake
cmake --build build
```



![image-20250805152949800](https://newbie-typora.oss-cn-shenzhen.aliyuncs.com/TyporaJPG/image-20250805152949800.png)



