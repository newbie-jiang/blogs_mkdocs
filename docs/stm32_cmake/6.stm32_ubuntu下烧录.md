# stm32 ubuntu烧录

我使用的是stlink烧录，在ubuntu上安装cubeprogrammer 工具

生成的默认只有elf文件

## elf文件转hex与bin文件

```
# 转 bin
arm-none-eabi-objcopy -O binary STM32H750XB.elf STM32H750XB.bin

# 转 hex
arm-none-eabi-objcopy -O ihex STM32H750XB.elf STM32H750XB.hex
```

## 烧录 bin 文件

### 默认擦除对应扇区

```
STM32_Programmer_CLI -c port=SWD -w STM32H750XB.bin 0x08000000 -v
```

- `-w STM32H750XB.bin 0x08000000`：指定 bin 文件写入起始地址，一般 STM32 Flash 起始地址为 `0x08000000`
- `-v`：写入后校验

### 擦除全部扇区

加 `-e all`

```
STM32_Programmer_CLI -c port=SWD -e all -w STM32H750XB.bin 0x08000000 -v
```



### 烧录 hex 文件

```
STM32_Programmer_CLI -c port=SWD -w STM32H750XB.hex -v
```

- 烧 hex 文件时**无需写入地址**，工具会自动按 hex 文件内部地址烧录
- 擦除全部扇区也是加 -e all  



## 烧录日志

### 烧录hex

```c
hdj@hdj-virtual-machine:~/stm32-cmake-for-vscode/build$ STM32_Programmer_CLI -c port=SWD -w STM32H750XB.hex -v
      -------------------------------------------------------------------
                        STM32CubeProgrammer v2.20.0                  
      -------------------------------------------------------------------

ST-LINK SN  : 0669FF505750888667051238
ST-LINK FW  : V2J43M28
Board       : --
Voltage     : 3.25V
SWD freq    : 4000 KHz
Connect mode: Normal
Reset mode  : Software reset
Device ID   : 0x450
Revision ID : Rev V
Device name : STM32H7xx
Flash size  : 128 KBytes
Device type : MCU
Device CPU  : Cortex-M7
BL Version  : 0x90



Opening and parsing file: STM32H750XB.hex


Memory Programming ...
  File          : STM32H750XB.hex
  Size          : 58.52 KB 
  Address       : 0x08000000


Erasing memory corresponding to segment 0:
Download in Progress:
[==================================================] 100% 

File download complete
Time elapsed during download operation: 00:00:09.568



Verifying...


Read progress:
[==================================================] 100% 

Time elapsed during verifying operation: 00:00:00.540


Download verified successfully 

```

### 烧录bin

```
hdj@hdj-virtual-machine:~/stm32-cmake-for-vscode/build$ STM32_Programmer_CLI -c port=SWD -w STM32H750XB.bin 0x08000000 -v
      -------------------------------------------------------------------
                        STM32CubeProgrammer v2.20.0                  
      -------------------------------------------------------------------

ST-LINK SN  : 0669FF505750888667051238
ST-LINK FW  : V2J43M28
Board       : --
Voltage     : 3.25V
SWD freq    : 4000 KHz
Connect mode: Normal
Reset mode  : Software reset
Device ID   : 0x450
Revision ID : Rev V
Device name : STM32H7xx
Flash size  : 128 KBytes
Device type : MCU
Device CPU  : Cortex-M7
BL Version  : 0x90



Opening and parsing file: STM32H750XB.bin


Memory Programming ...
  File          : STM32H750XB.bin
  Size          : 58.52 KB 
  Address       : 0x08000000


Erasing memory corresponding to segment 0:
Download in Progress:
[==================================================] 100% 

File download complete
Time elapsed during download operation: 00:00:09.541



Verifying...


Read progress:
[==================================================] 100% 

Time elapsed during verifying operation: 00:00:00.565


Download verified successfully 

```



## 